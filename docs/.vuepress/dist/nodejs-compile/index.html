<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>åç«¯ Nodejs é…ç½® | Xerrors</title>
    <meta name="description" content="Xerrors playground">
    <link rel="manifest" href="/manifest.json">
  <link rel="apple-touch-icon" href="/favicon.png">
    
    <link rel="preload" href="/assets/css/0.styles.655ad899.css" as="style"><link rel="preload" href="/assets/js/app.e2860514.js" as="script"><link rel="preload" href="/assets/js/7.b3d46475.js" as="script"><link rel="preload" href="/assets/js/31.9a9c566f.js" as="script"><link rel="prefetch" href="/assets/js/1.d2302d19.js"><link rel="prefetch" href="/assets/js/10.363a5f2e.js"><link rel="prefetch" href="/assets/js/11.a450bcf4.js"><link rel="prefetch" href="/assets/js/12.82e844ca.js"><link rel="prefetch" href="/assets/js/13.fe61535e.js"><link rel="prefetch" href="/assets/js/14.4a644140.js"><link rel="prefetch" href="/assets/js/15.91d9f7b2.js"><link rel="prefetch" href="/assets/js/16.9fa16092.js"><link rel="prefetch" href="/assets/js/17.1109ac86.js"><link rel="prefetch" href="/assets/js/18.b496fab0.js"><link rel="prefetch" href="/assets/js/19.c1337c49.js"><link rel="prefetch" href="/assets/js/2.64cb9093.js"><link rel="prefetch" href="/assets/js/20.adb9c468.js"><link rel="prefetch" href="/assets/js/21.0b801de1.js"><link rel="prefetch" href="/assets/js/22.e226cd6c.js"><link rel="prefetch" href="/assets/js/23.7e4bf0b7.js"><link rel="prefetch" href="/assets/js/24.531710cb.js"><link rel="prefetch" href="/assets/js/25.8f290cfc.js"><link rel="prefetch" href="/assets/js/26.7a2413df.js"><link rel="prefetch" href="/assets/js/27.501750f5.js"><link rel="prefetch" href="/assets/js/28.c9a0adb4.js"><link rel="prefetch" href="/assets/js/29.72f1bbac.js"><link rel="prefetch" href="/assets/js/30.43d9e62a.js"><link rel="prefetch" href="/assets/js/32.57b91ebe.js"><link rel="prefetch" href="/assets/js/33.2501e341.js"><link rel="prefetch" href="/assets/js/34.059a7ff2.js"><link rel="prefetch" href="/assets/js/35.f762ef37.js"><link rel="prefetch" href="/assets/js/36.48ae2338.js"><link rel="prefetch" href="/assets/js/37.96d8c490.js"><link rel="prefetch" href="/assets/js/38.e946d314.js"><link rel="prefetch" href="/assets/js/39.d3f25431.js"><link rel="prefetch" href="/assets/js/4.a16b4593.js"><link rel="prefetch" href="/assets/js/40.7cac8664.js"><link rel="prefetch" href="/assets/js/41.55074705.js"><link rel="prefetch" href="/assets/js/42.bccf86c5.js"><link rel="prefetch" href="/assets/js/43.4354f2a0.js"><link rel="prefetch" href="/assets/js/44.27eb8fb7.js"><link rel="prefetch" href="/assets/js/45.7edf95e7.js"><link rel="prefetch" href="/assets/js/46.051b3701.js"><link rel="prefetch" href="/assets/js/47.d3f63876.js"><link rel="prefetch" href="/assets/js/5.20ac7044.js"><link rel="prefetch" href="/assets/js/6.0b7e65d8.js"><link rel="prefetch" href="/assets/js/8.3b82d74a.js"><link rel="prefetch" href="/assets/js/9.c6854e86.js">
    <link rel="stylesheet" href="/assets/css/0.styles.655ad899.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><!----> <div id="my-bg"></div> <header class="navbar my-nav"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/avatar.jpg" alt="Xerrors" class="logo"> <span class="site-name can-hide">Xerrors</span></a> <div class="links"><!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">ğŸ“ƒ æ–‡ç« </a></div><div class="nav-item"><a href="/zhuanlan/" class="nav-link">ğŸ“° ä¸“æ </a></div><div class="nav-item"><a href="/zone/" class="nav-link">ğŸ¤ª åŠ¨æ€</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">ğŸ”¨ å·¥å…·</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/" class="nav-link">ğŸš¥ å¯¼èˆª</a></li><li class="dropdown-item"><!----> <a href="/tools/findpwd.html" class="nav-link">ğŸ” å¯»å¯†</a></li><li class="dropdown-item"><!----> <a href="/tools/links.html" class="nav-link">ğŸ”— å‹é“¾</a></li><li class="dropdown-item"><!----> <a href="https://www.notion.so/krance/7af4256cdc35438d919833f4c6192128?v=5219488bae934ab3a621e7c8b123d08b" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ‘©â€ğŸš€ Notion
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">ğŸ“ƒ æ–‡ç« </a></div><div class="nav-item"><a href="/zhuanlan/" class="nav-link">ğŸ“° ä¸“æ </a></div><div class="nav-item"><a href="/zone/" class="nav-link">ğŸ¤ª åŠ¨æ€</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">ğŸ”¨ å·¥å…·</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/" class="nav-link">ğŸš¥ å¯¼èˆª</a></li><li class="dropdown-item"><!----> <a href="/tools/findpwd.html" class="nav-link">ğŸ” å¯»å¯†</a></li><li class="dropdown-item"><!----> <a href="/tools/links.html" class="nav-link">ğŸ”— å‹é“¾</a></li><li class="dropdown-item"><!----> <a href="https://www.notion.so/krance/7af4256cdc35438d919833f4c6192128?v=5219488bae934ab3a621e7c8b123d08b" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ‘©â€ğŸš€ Notion
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <!----> </aside> <div><div style="height:4.5rem;width:100%;background:#f0f2f5;"></div> <main class="page need-zoom"> <div class="my-main"><div class="my-main-left"><div class="my-title-box"><h3 style="text-align: center;">åç«¯ Nodejs é…ç½®</h3> <div style="text-align: center; color: #A0A0A0; font-size: 14px;"><span data-flag-title="Your Article Title" class="leancloud-visitors"><span>2019-8-29 â€‚</span> <i class="el-icon-view" style="margin-right: 3px;"></i> <span class="leancloud-visitors-count"></span> <span>æ¬¡æµè§ˆ</span></span></div></div> <div class="theme-default-content content__default"><h3 id="å‰è¨€"><a href="#å‰è¨€" aria-hidden="true" class="header-anchor">#</a> å‰è¨€</h3> <p>ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¹ˆä¸€ç¯‡æ–‡ç« å‘¢ï¼›åŸæœ¬æˆ‘åªæ˜¯æƒ³è¦ä½¿ç”¨ Vuepress æ­å»ºä¸€ä¸ªé™æ€åšå®¢å°±å¥½çš„ï¼Œç„¶åè‡ªå·±ä¿®æ”¹ä¸€ä¸‹ä¸»é¢˜ä¹‹ç±»çš„å°±å¯ä»¥äº†ï¼Œä½†æ˜¯å§ï¼Œè¿™äººä¸€æ—¦é—²ç€å°±æ²¡äº‹å¹²ï¼Œæƒ³æƒ³è‡ªå·±å¤©å¤©ä¸å‘ç©ºé—´ã€ä¸å‘æœ‹å‹åœˆã€ä¸å‘å¾®åšï¼Œæœ‰ç‚¹å•¥æƒ³è¯´çš„ä¹Ÿæ²¡åœ°æ–¹è¯´ï¼Œæƒ³äº†æƒ³ï¼Œä¸å¦‚æ”¾åˆ°è‡ªå·±çš„ç½‘ç«™é‡Œé¢ï¼Œä½†æ˜¯å•ç‹¬å†™ä¸€ç¯‡æ–‡ç« ä¹Ÿä¸å€¼å¾—ï¼Œ<strong>ç´¢æ€§è‡ªå·±åšä¸€ä¸ªç±»ä¼¼åŠ¨æ€ä¸€æ ·çš„ä¸œè¥¿å§</strong>ã€‚æ­£å¥½å½“æ—¶åœ¨é€› GitHub çš„ issuesï¼Œç„¶åå°±å€Ÿé‰´é‚£ä¸ªé£æ ¼åšä¸€ä¸ªï¼Œä½†æ˜¯æ¯æ¬¡å‘æ¶ˆæ¯éƒ½è¦è¿æ¥æœåŠ¡å™¨ï¼Œå†™å†…å®¹ï¼Œå‘å¸ƒï¼Œæ„Ÿè§‰æŒºéº»çƒ¦çš„ï¼Œæ‰€ä»¥è¿˜æ˜¯å»ºä¸€ä¸ªåç«¯å§ï¼ŒåŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œä¹Ÿ<strong>ç”¨ä¸åˆ°æ•°æ®åº“ï¼Œå°±ç”¨ JSON ç®¡ç†å§</strong>ã€‚</p> <p>è¯´å¹²å°±å¹²ï¼</p> <h3 id="å®‰è£…"><a href="#å®‰è£…" aria-hidden="true" class="header-anchor">#</a> å®‰è£…</h3> <p>åœ¨ä½¿ç”¨ä¹‹å‰è¿˜æ˜¯è¦å®‰è£…ä¸€äº›æ–°çš„ä¸œè¥¿ï¼Œåç«¯ä½¿ç”¨ express æ¥ç®¡ç†ä¼šå¥½ä¸€ç‚¹ã€‚ï¼ˆå¦ä¸€æ–¹é¢ä¹Ÿæ˜¯ä¸ºäº†åé¢æ–¹ä¾¿çš„é…ç½® httpsï¼‰</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> express --save
</code></pre></div><p>å½“ç„¶ï¼Œå‰ç«¯å› ä¸ºä¹Ÿè¦å‘é€è¯·æ±‚ï¼Œæ‰€ä»¥ä¹Ÿéœ€è¦å®‰è£… <code>axios</code></p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> axios --save
</code></pre></div><h3 id="ç®€å•çš„ä¾‹å­"><a href="#ç®€å•çš„ä¾‹å­" aria-hidden="true" class="header-anchor">#</a> ç®€å•çš„ä¾‹å­</h3> <p>é¦–å…ˆï¼Œå› ä¸ºæ˜¯åç«¯ä»£ç è¿˜æ˜¯è·Ÿå‰ç«¯åˆ†å¼€ä¸€ç‚¹å¥½ï¼Œæ‰€ä»¥æˆ‘å¦å»ºäº†ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼ŒåŒæ—¶æ–°å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ <code>server.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å¼•å…¥ç›¸åº”çš„æ¨¡å—</span>
<span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// åˆ›å»º Server </span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> httpServer <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// ç›‘å¬</span>
<span class="token keyword">var</span> <span class="token constant">PORT</span> <span class="token operator">=</span> <span class="token number">8000</span>	<span class="token comment">// ç«¯å£</span>
httpServer<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'HTTP Server is running on: '</span><span class="token punctuation">,</span> <span class="token constant">PORT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Get è¯·æ±‚</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&quot;Nodejs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ä¸Šé¢å°±æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä¸Šé¢çš„ç®€å•ä»£ç å°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è®¿é—® 8000 ç«¯å£å¹¶çœ‹åˆ°ç»“æœäº†ã€‚</p> <p>é€»è¾‘å¾ˆç®€å•ï¼Œé¦–å…ˆå¼•å…¥ç›¸åº”çš„æ¨¡å—ï¼ˆå‰ä¸‰è¡Œä»£ç ï¼‰ï¼Œç„¶åç”¨å®ä¾‹åˆ›å»º Http æœåŠ¡å™¨ï¼Œç¬¬ä¸‰æ­¥å¼€å¯ç›‘å¬ï¼Œç¬¬å››æ­¥å¯¹è¯·æ±‚ä½œå‡ºååº”ã€‚</p> <h3 id="å¤„ç†è·¨åŸŸ"><a href="#å¤„ç†è·¨åŸŸ" aria-hidden="true" class="header-anchor">#</a> å¤„ç†è·¨åŸŸ</h3> <p>å› ä¸ºæˆ‘æ˜¯æŠŠåšå®¢ä»£ç æ”¾åˆ° GitHub Pagesã€Coding Page å’Œæˆ‘çš„æœåŠ¡å™¨ä¸Šé¢çš„ï¼Œæ‰€ä»¥è¿›è¡Œæ•°æ®è¯·æ±‚çš„æ—¶å€™è‚¯å®šæ˜¯å±äºè·¨åŸŸè®¿é—®çš„ï¼Œæ‰€ä»¥æˆ‘å°±éœ€è¦åœ¨å¤„ç†è¯·æ±‚çš„æ—¶å€™å…è®¸è·¨åŸŸã€‚</p> <p>æ‰€ä»¥å¯¹ä»£ç è¿›è¡Œä¿®æ”¹</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å¼•å…¥ç›¸åº”çš„æ¨¡å—</span>
<span class="token operator">...</span>

<span class="token comment">// å…è®¸æ‰€æœ‰çš„è¯·æ±‚å½¢å¼</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Origin&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Headers&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// åˆ›å»º Server</span>
<span class="token operator">...</span>
</code></pre></div><h3 id="å¤„ç†-json-æ–‡ä»¶"><a href="#å¤„ç†-json-æ–‡ä»¶" aria-hidden="true" class="header-anchor">#</a> å¤„ç† JSON æ–‡ä»¶</h3> <p>å¤„ç†æ–‡ä»¶ä¹Ÿå°±ä¸¤ç§ï¼Œä¸€ç§æ˜¯è¯»ï¼Œä¸€ç§æ˜¯å†™ï¼Œä¹Ÿå°±å¯¹åº”ç€ç½‘ç«™ä¸­å‡ºç°çš„ <code>GET</code>ã€<code>POST</code>; é¦–å…ˆçº¦å®šå¥½ï¼Œæ‰€æœ‰çš„æ•°æ®æ”¾åˆ°ä¸€ä¸ª <code>data.json</code> æ–‡ä»¶é‡Œé¢ï¼Œæ ¼å¼ä¸ºï¼š</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;msgs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;date&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2019-08-27T07:01:47.603Z&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ä¹¦ç­¾å¼€å‘å®Œæˆå’¯ï¼å°±å·®å¾€é‡Œé¢å¡«èµ„æºäº†ï¼Œä¸è¿‡ï¼Œä¸€ä¸ªä¸€ä¸ªæ•´ç†æ˜¯çœŸçš„éº»çƒ¦å•Šï¼ï¼ï¼&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;status&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Happy&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        ...
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="è¯»å–æ–‡ä»¶"><a href="#è¯»å–æ–‡ä»¶" aria-hidden="true" class="header-anchor">#</a> è¯»å–æ–‡ä»¶</h4> <p>å½“æ¥æ”¶åˆ°ç›¸åº”çš„ <code>get</code> è¯·æ±‚çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯æŒ‡å®š API çš„æ—¶å€™ï¼Œå‘æœåŠ¡å™¨ä¸­è¯»  <code>data.json</code>  ï¼Œç„¶åå°†ç»“æœè¿”å›ç»™å‰ç«¯ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Get è¯·æ±‚</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/getData'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// å“åº”å¤´</span>
    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'text/html'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> file <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./data.json'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å‰ç«¯ç›¸åº”çš„ä»£ç å¦‚ä¸‹ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">getMsgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'http://localhost:8000/api/getData'</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token comment">// console.log(res);</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> item <span class="token keyword">of</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                item<span class="token punctuation">.</span>date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>date<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>msgs <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="å†™å…¥æ–‡ä»¶"><a href="#å†™å…¥æ–‡ä»¶" aria-hidden="true" class="header-anchor">#</a> å†™å…¥æ–‡ä»¶</h4> <p>åç«¯çš„åœ¨å¤„ç† post è¯·æ±‚çš„æ—¶å€™ï¼Œæœ‰ä¸€ä¸ªæ˜¯éœ€è¦æ³¨æ„çš„ï¼Œé‚£å°±æ˜¯å‚æ•°çš„è§£æï¼Œæ‰€ä»¥ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬å†æ¬¡å¼•å…¥ä¸€ä¸ªæ–°çš„ä¸œä¸œ</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å¼•å…¥ç›¸åº”çš„æ¨¡å—</span>
<span class="token operator">...</span>

<span class="token keyword">var</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// æ·»åŠ jsonè§£æ</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span>extended<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å…è®¸æ‰€æœ‰çš„è¯·æ±‚å½¢å¼</span>
<span class="token operator">...</span>
</code></pre></div><p>é€šè¿‡è¿™æ ·è®¾ç½®ï¼Œå½“å‰ç«¯æŠŠæ•°æ®ä¼ é€åˆ°åç«¯ä¹‹åï¼Œå°±å¯ä»¥ç›´æ¥å½“ä½œ JavaScript çš„å¯¹è±¡ä½¿ç”¨äº†ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">...</span>

<span class="token comment">// Post è¯·æ±‚</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/upload'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'text/html'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">var</span> body <span class="token operator">=</span> req<span class="token punctuation">.</span>body
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">,</span> body<span class="token punctuation">)</span>
    
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&quot;POST&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ä¸Šé¢æ˜¯ä¸€ä¸ªç®€å•çš„ä½¿ç”¨æ–¹æ³•ï¼Œä¸‹ä¸€æ­¥è¦åšçš„å°±æ˜¯è¯»å– <code>json</code> æ–‡ä»¶é‡Œé¢çš„æ•°æ®ï¼Œè½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œç„¶åè§£ææˆ JavaScript çš„å¯¹è±¡ã€‚ç„¶åæŠŠå‰ç«¯ä¼ æ¥çš„æ•°æ®æ’å…¥åˆ°æœ€å‰é¢ï¼Œæœ€åå†è½¬åŒ–æˆå­—ç¬¦ä¸²å†™åˆ°æ–‡ä»¶ä¸­ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Post è¯·æ±‚</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/upload'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'text/html'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">var</span> body <span class="token operator">=</span> req<span class="token punctuation">.</span>body
    <span class="token comment">// console.log(typeof(body), body)</span>
    
    fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./data.json'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> jsonData</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> msgs <span class="token operator">=</span> jsonData<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>		<span class="token comment">// è½¬åŒ–è¯»å–åˆ°çš„ json æ•°æ®ä¸ºå­—ç¬¦ä¸²</span>
            msgs <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>msgs<span class="token punctuation">)</span>				<span class="token comment">// è§£æä¸º js å¯¹è±¡</span>
            msgs<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> body<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// æŠŠæ–°æ•°æ®æ’å…¥åˆ° js å¯¹è±¡ä¸­</span>
            <span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>msgs<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</span>
            fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">'./data.json'</span><span class="token punctuation">,</span> str<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ–°å¢æˆåŠŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">&quot;POST&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="æƒé™æ§åˆ¶"><a href="#æƒé™æ§åˆ¶" aria-hidden="true" class="header-anchor">#</a> æƒé™æ§åˆ¶</h3> <p>ä¸Šè¿° post çš„ API  å¯ä»¥ç›´æ¥ä¿®æ”¹æˆ‘ä»¬æœåŠ¡å™¨çš„æ•°æ®ï¼Œæ‰€ä»¥è‚¯å®šæ˜¯è¦è¿›è¡Œæƒé™æ§åˆ¶ï¼Œä¸ç„¶å°±å®Œè›‹äº†ã€‚ä½†æ˜¯å•ç‹¬å¼€å‘ä¸€ä¸ªåå°ç®¡ç†ç³»ç»Ÿä¹Ÿå¤ªéº»çƒ¦äº†ï¼Œæ‰€ä»¥æœ€ç®€å•çš„åŠæ³•å°±æ˜¯ä½¿ç”¨ä¸€ä¸ª token å»éªŒè¯å’¯ï¼ˆå½“ç„¶ï¼Œtoken çš„é•¿åº¦æœ€å¥½é•¿ä¸€ç‚¹ï¼Œä¸ç„¶ï¼Œä¸€ä¼šå„¿å°±çˆ†ç ´å‡ºæ¥äº†ï¼‰ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Post è¯·æ±‚</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/upload'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'text/html'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
        code<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
        message<span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> body <span class="token operator">=</span> req<span class="token punctuation">.</span>body
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>body<span class="token punctuation">.</span>token <span class="token operator">!=</span> <span class="token string">'mytoken'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        data<span class="token punctuation">.</span>code <span class="token operator">=</span> <span class="token number">220</span>
        data<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&quot;Wrong Token!&quot;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Wrong Token!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./data.json'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> jsonData</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token operator">...</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        data<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&quot;Success&quot;</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Success!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å‰ç«¯ç›¸åº”ä»£ç </p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">uploadMsg</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">axios</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        method<span class="token punctuation">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
        url<span class="token punctuation">:</span> <span class="token string">'http://localhost:8000/api/upload'</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span> data
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>code <span class="token operator">!=</span> <span class="token number">200</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="https-è®¿é—®"><a href="#https-è®¿é—®" aria-hidden="true" class="header-anchor">#</a> HTTPS è®¿é—®</h3> <p>éƒ¨ç½²çš„æ—¶å€™å‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå½“æˆ‘çš„ç½‘ç«™æ˜¯ https è®¿é—®ï¼Œå»è®¿é—® http çš„ API ä¼šå¯¼è‡´æ— æ³•è®¿é—®ï¼ˆä¿ºä¹Ÿæ²¡å­¦è¿‡è¿™æ–¹é¢çš„ï¼Œè¿˜ä¸æ‡‚ï¼‰ï¼Œæ‰€ä»¥ç´¢æ€§å°±åœ¨åç«¯å¯åŠ¨ä¸€ä¸ª https æœåŠ¡å™¨æ¥å¤„ç†è¯·æ±‚ã€‚</p> <p>SSL è¯ä¹¦å¯ä»¥å»é˜¿é‡Œäº‘æˆ–è€…å…¶ä»–åœ°æ–¹ç”³è¯·å…è´¹çš„ï¼Œä¸€å¹´æœ‰æ•ˆæœŸï¼Œä¸€å¹´åé‡æ–°ç”³è¯·ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å¼•å…¥ç›¸åº”çš„æ¨¡å—</span>
<span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ssl è¯ä¹¦</span>
<span class="token keyword">var</span> privateKey  <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'domain.key'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> certificate <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'domain_public.crt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> credentials <span class="token operator">=</span> <span class="token punctuation">{</span>key<span class="token punctuation">:</span> privateKey<span class="token punctuation">,</span> cert<span class="token punctuation">:</span> certificate<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// åˆ›å»º Server </span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> https <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> httpServer <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> httpsServer <span class="token operator">=</span> https<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>credentials<span class="token punctuation">,</span> app<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// ç›‘å¬</span>
<span class="token keyword">var</span> <span class="token constant">PORT</span> <span class="token operator">=</span> <span class="token number">8000</span>	<span class="token comment">// ç«¯å£</span>
httpServer<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'HTTP Server is running on: '</span><span class="token punctuation">,</span> <span class="token constant">PORT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> <span class="token constant">SSLPORT</span> <span class="token operator">=</span> <span class="token number">8001</span>
httpsServer<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token constant">SSLPORT</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'HTTPS Server is running on: '</span><span class="token punctuation">,</span> <span class="token constant">SSLPORT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="æ€»ç»“"><a href="#æ€»ç»“" aria-hidden="true" class="header-anchor">#</a> æ€»ç»“</h3> <p>ä¸Šé¢å°±æ˜¯ä¸€ä¸ªèœé¸¡å‰ç«¯çš„åç«¯ä½“éªŒï¼Œåé¢ä¼šæ›´æ–°ä½¿ç”¨ flask åšåç«¯çš„ä¾‹å­ã€‚</p> <p>å®Œæ•´ä»£ç ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> https <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> privateKey  <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'www.xerrors.fun.key'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> certificate <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'www.xerrors.fun_public.crt'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> credentials <span class="token operator">=</span> <span class="token punctuation">{</span>key<span class="token punctuation">:</span> privateKey<span class="token punctuation">,</span> cert<span class="token punctuation">:</span> certificate<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> httpServer <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> httpsServer <span class="token operator">=</span> https<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>credentials<span class="token punctuation">,</span> app<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token constant">PORT</span> <span class="token operator">=</span> <span class="token number">8000</span>
<span class="token keyword">var</span> <span class="token constant">SSLPORT</span> <span class="token operator">=</span> <span class="token number">8001</span>

<span class="token keyword">var</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// æ·»åŠ jsonè§£æ</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span>extended<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/public'</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span><span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å…è®¸æ‰€æœ‰çš„è¯·æ±‚å½¢å¼</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Origin&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Headers&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// åˆ›å»º Server</span>
httpServer<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token constant">PORT</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'HTTP Server is running on: '</span><span class="token punctuation">,</span> <span class="token constant">PORT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
httpsServer<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token constant">SSLPORT</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'HTTPS Server is running on: '</span><span class="token punctuation">,</span> <span class="token constant">SSLPORT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// Get è¯·æ±‚</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/api/getData'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'text/html'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> file <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./data.json'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Post è¯·æ±‚</span>
app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/upload'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'text/html'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
        code<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
        message<span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        data<span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> body <span class="token operator">=</span> req<span class="token punctuation">.</span>body
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">,</span> req<span class="token punctuation">.</span>body<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>body<span class="token punctuation">.</span>token <span class="token operator">!=</span> <span class="token string">'mytoken'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        data<span class="token punctuation">.</span>code <span class="token operator">=</span> <span class="token number">220</span>
        data<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&quot;Wrong Token!&quot;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Wrong Token!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span><span class="token string">'./data.json'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> jsonData</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token keyword">var</span> msgs <span class="token operator">=</span> jsonData<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                msgs <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>msgs<span class="token punctuation">)</span>
                msgs<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> body<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>msgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
                fs<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span><span class="token string">'./data.json'</span><span class="token punctuation">,</span> str<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ–°å¢æˆåŠŸ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        data<span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&quot;Success&quot;</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Success!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å¯åŠ¨å®Œæˆ'</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">ä¿®æ”¹äº: </span> <span class="time">9/1/2019, 10:55:27 AM</span></div></footer> <!----> <div style="background:white;"><section class="page-edit"><div id="vcomments"></div></section></div></div> <div class="my-menu" style="display:;"><div class="my-menu__item"><h4 style="margin-top: 0; color: #121314">ç›®å½•</h4> <a href="/nodejs-compile/#å‰è¨€" class="my-menu__lv3">
            å‰è¨€</a><a href="/nodejs-compile/#å®‰è£…" class="my-menu__lv3">
            å®‰è£…</a><a href="/nodejs-compile/#ç®€å•çš„ä¾‹å­" class="my-menu__lv3">
            ç®€å•çš„ä¾‹å­</a><a href="/nodejs-compile/#å¤„ç†è·¨åŸŸ" class="my-menu__lv3">
            å¤„ç†è·¨åŸŸ</a><a href="/nodejs-compile/#å¤„ç†-json-æ–‡ä»¶" class="my-menu__lv3">
            å¤„ç† JSON æ–‡ä»¶</a><a href="/nodejs-compile/#æƒé™æ§åˆ¶" class="my-menu__lv3">
            æƒé™æ§åˆ¶</a><a href="/nodejs-compile/#https-è®¿é—®" class="my-menu__lv3">
            HTTPS è®¿é—®</a><a href="/nodejs-compile/#æ€»ç»“" class="my-menu__lv3">
            æ€»ç»“</a></div></div></div> </main></div> <div class="footer">
    Copyright Â© 2019-2020 â¤ï¸ Xerrors | çš– ICP å¤‡ 19016269 å· <br> <a href="https://me.csdn.net/jaykm">CSND</a> | 
    <a href="https://github.com/Xerrors">GitHub</a></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e2860514.js" defer></script><script src="/assets/js/7.b3d46475.js" defer></script><script src="/assets/js/31.9a9c566f.js" defer></script>
  </body>
</html>
